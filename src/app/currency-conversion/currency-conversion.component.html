<div class="container pt">
  <h2 class="text-center">Conversão de Moedas</h2>

  <form [formGroup]="formConverter" (ngSubmit)="submit()">
    <div class="container-coins">

      <mat-form-field appearance="fill">
        <mat-label class="text-dark">Moeda de origem</mat-label>
        <mat-select formControlName="moedaOrigem" name="moedaOrigem" (selectionChange)="clearError()">
          <mat-option *ngFor="let moeda of moedas" [value]="moeda">{{ moeda}} </mat-option>
        </mat-select>
        <mat-error *ngIf="formConverter.get('moedaOrigem')?.hasError('required')">Campo
          obrigatório</mat-error>
        <mat-error
          *ngIf="formConverter.get('moedaOrigem')?.hasError('equalCurrencies') && formConverter.get('moedaOrigem')?.value">Moeda
          não pode ser
          igual</mat-error>

      </mat-form-field>

      <div class="p-3" title="Inverter moedas">
        <div class="icon-container" (click)="inverterMoedas()">
          <mat-icon>swap_horiz</mat-icon>
        </div>
      </div>

      <mat-form-field appearance="fill">
        <mat-label class="text-dark">Moeda de destino</mat-label>
        <mat-select formControlName="moedaDestino" name="moedaDestino" (selectionChange)="clearError()">
          <mat-option *ngFor="let moeda of moedas" [value]="moeda">{{ moeda }}</mat-option>
        </mat-select>
        <mat-error *ngIf="formConverter.get('moedaDestino')?.hasError('required')">Campo
          obrigatório</mat-error>
        <mat-error
          *ngIf="formConverter.get('moedaDestino')?.hasError('equalCurrencies') && formConverter.get('moedaDestino')?.value">Moeda
          não pode ser
          igual</mat-error>

      </mat-form-field>
    </div>

    <div class="container-value">
      <mat-form-field appearance="fill">
        <span matPrefix *ngIf="!this.formConverter.value.moedaOrigem" class="p-2 fw-bold">$</span>
        <span matTextPrefix *ngIf="this.formConverter.value.moedaOrigem"
          class="p-2 fw-bold">{{this.formConverter.value.moedaOrigem}}</span>
        <mat-label class="text-dark">Valor da moeda</mat-label>
        <input matInput class="text-dark" type="number" formControlName="valorConversao" name="valorConversao" min="0">
        <mat-error *ngIf="formConverter.get('valorConversao')?.hasError('required')">
          Valor nulo ou inválido
        </mat-error>
        <mat-error *ngIf="formConverter.get('valorConversao')?.hasError('min')">Valor deve ser maior que 0</mat-error>
      </mat-form-field>
    </div>


    <div class="container-button">
      <button type="submit" class="btn btn-success" [disabled]="!formConverter.valid">Converter</button>
    </div>
  </form>

  <div *ngIf="loading" class="text-center mt-3">
    <div class="spinner-border text-success" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p>Convertendo...</p>
  </div>

  <div *ngIf="isDataReturned && !loading" class="result">
    <p *ngIf="valorMaior>10000">{{valorMaior}}</p>
    <p> <strong>Resultado:</strong> {{ valor }} em <strong>{{ simboloOrigem}}</strong> equivale a {{valorConvertido}} em
      <strong>{{
        simboloDestino }}</strong>
    </p>
    <p><strong> Taxa de conversão: </strong> {{ taxaConversao }}</p>
  </div>

</div>